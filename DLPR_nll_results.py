import csv


experiment_result = [
    {
    'filename':'TRIPLESAT_2_MS_L1_20191107021947_001FFCVI_002_0120200811001001_001.tif',
    'jxl_dlpr_linear':{'psnr': [55.2766349611062, 53.21454503297089, 51.770380684020225, 50.73750024461977, 49.969709506141186, 49.38070055051783, 48.51943194856781, 46.79792789578548, 45.09014187411731, 43.03443205240822, 41.0949956910974], 'bpsp': [1.237904714088222, 0.8661301800317631, 0.691244950934502, 0.5858947632670352, 0.5154037247590307, 0.46620712979476, 0.40163254134698695, 0.3023085974885857, 0.26031257572508676, 0.23599850772548425, 0.22112196031874704]},
    'jxl_dlpr_msb':{'psnr': [52.98120258484914, 50.99334059282768, 49.74214918415462, 48.92945539670815, 48.36996932630051, 47.96246236575904, 47.383120035886805, 46.12180968667434, 44.63601493289833, 42.74628733772676], 'bpsp': [1.0309648356667556, 0.7124135622649799, 0.565902956830381, 0.4808446692153879, 0.4262798956105163, 0.3895667348301405, 0.34194926615308713, 0.2633318166524587, 0.22346354125807807, 0.19916847535219248]},
    },
    {
    'filename':'TRIPLESAT_2_MS_L1_20191107021950_001FFCVI_003_0120200811001001_002.tif',
    'jxl_dlpr_linear':{'psnr': [54.58049546904823, 52.46454202429591, 51.05683463972399, 50.042059784839864, 49.27149627265169, 48.66468732016675, 47.74980627414056, 45.81576347494527, 43.88380815027997, 41.72844194170271, 39.894154737955965], 'bpsp': [1.5896485658649178, 1.1393755807405934, 0.9061563994344698, 0.7707115673938019, 0.6818622400504863, 0.6191709508543097, 0.5351557212863546, 0.3981958470837016, 0.33819120987551016, 0.3038131449162426, 0.28377946414095717]},
    'jxl_dlpr_msb':{'psnr': [52.52947682182824, 50.49386845047182, 49.23582158574955, 48.39443657670426, 47.79314055682548, 47.3382821435999, 46.665895296783845, 45.15406021321944, 43.455527103324975, 41.462803453681104, 39.71822821518222], 'bpsp': [1.3916620556081454, 0.982862726434353, 0.7835939758132984, 0.6693213114582625, 0.5955584959406995, 0.5443330003608654, 0.47604773883801327, 0.3582557821279207, 0.3002232833177307, 0.2658599319062587, 0.24582632086342723]},
    },
    {
    'filename':'TRIPLESAT_2_MS_L1_20191107021954_001FFCVI_004_0120200811001001_001.tif',
    'jxl_dlpr_linear':{'psnr': [55.036865755283564, 53.21418913934107, 52.137747531698494, 51.35392279693075, 50.718272659010594, 50.17816884832578, 49.29265022842736, 47.181009455770926, 44.96625588508657, 42.755517975712635, 41.106483641603866], 'bpsp': [1.3577611000991945, 0.8966344328398019, 0.6844409113334414, 0.583757463551718, 0.5251709055282147, 0.4844475707827991, 0.42734453585206955, 0.32241933262554895, 0.2685840302220456, 0.2384780891912953, 0.2230291778020679]},
    'jxl_dlpr_msb':{'psnr': [53.87986797062069, 52.27124859838529, 51.32732999117651, 50.63885921295029, 50.08195721427535, 49.60852342072312, 48.82593518271115, 46.89835988124397, 44.796127195653234, 42.65245786724176, 41.03575060016321], 'bpsp': [1.2401001358039543, 0.8144961917363556, 0.6328255416032538, 0.5451295890492154, 0.49219606674093175, 0.4545509665789781, 0.4008934819331928, 0.29960123496176044, 0.24616365160968653, 0.21606433516206694, 0.20061549350529356]},
    },
    {
    'filename':'TRIPLESAT_2_MS_L1_20200109023258_002115VI_003_0120200811001001_001.tif',
    'jxl_dlpr_linear':{'psnr': [55.8759646993262, 53.828603261851384, 52.5138896271785, 51.60863804092463, 50.94145610094741, 50.424882020757536, 49.654314641313434, 48.07670428284965, 46.265514448521174, 44.16524697629861, 42.39247148628425], 'bpsp': [1.3201109651486147, 0.9166349208752871, 0.7143203679096194, 0.5989635905596337, 0.525546457086395, 0.47609180578322763, 0.4138682711604607, 0.32320582436631456, 0.28215070480536303, 0.256939557645301, 0.244144998386841]},
    'jxl_dlpr_msb':{'psnr': [53.916018206087585, 52.03079517010606, 50.92572138131132, 50.213832666344295, 49.71054332776638, 49.326784992248434, 48.74633912075173, 47.46122215827861, 45.85260671972576, 43.906153025291836, 42.218503400531624], 'bpsp': [1.128999029580751, 0.7711810973940015, 0.6058635869000553, 0.5138735291754634, 0.45604737765966175, 0.41713981650789567, 0.36711871293888126, 0.2871389037164912, 0.24672386545707084, 0.22152035714120463, 0.20872606709311273]},
    },
    {
    'filename':'TRIPLESAT_2_MS_L1_20200109023301_002115VI_004_0120200811001001_001.tif',
    'jxl_dlpr_linear':{'psnr': [56.026772795999065, 54.2357069969054, 53.111000542357694, 52.27810715294243, 51.607800432491416, 51.044707973720435, 50.172211189468506, 48.23047192132306, 46.08835870471638, 44.06009628407246, 42.66961670170541], 'bpsp': [1.2632687775283375, 0.8125615913361374, 0.618206781325045, 0.5270523525831365, 0.4719240254689834, 0.4326785043513229, 0.377711165037313, 0.2893344825250923, 0.24330388424290683, 0.2178103354066738, 0.20715159025508945]},
    'jxl_dlpr_msb':{'psnr': [54.53995759413018, 52.84623290596616, 51.86649290425001, 51.19301345727294, 50.654866309892995, 50.20027549994474, 49.48272851223837, 47.7949694224847, 45.818928011678175, 43.88935893493723, 42.5449798474444], 'bpsp': [1.0591901563228892, 0.674421304972021, 0.5327817885916217, 0.46296830510620557, 0.41725372614491174, 0.38321762755839234, 0.33390165324610915, 0.2505086267200545, 0.20483816460783832, 0.17935047109711216, 0.16869206245848797]},
    },
    {
    'filename':'GF6_WFI_Sample_A.tif',
    'jxl_dlpr_linear':{'psnr': [56.25034868884583, 54.3082854993287, 52.907009959388496, 51.83630108388252, 50.95439168311961, 50.22006662776203, 49.024176481244204, 46.1202458499778, 42.938454317418504, 40.43173890852164, 37.832907446249806], 'bpsp': [1.6635305, 1.3345986111111112, 1.121514388888889, 0.9801379722222222, 0.8780091666666666, 0.8025865277777777, 0.6911403055555555, 0.4641416388888889, 0.29924391666666667, 0.23907444444444445, 0.20301769444444445]},
    'jxl_dlpr_msb':{'psnr': [55.68721263654864, 53.65871892293332, 52.24851507798746, 51.180646834172634, 50.30959048068273, 49.59236087569558, 48.45132596216078, 45.78913955564155, 42.793727250763325, 40.350801999382014, 37.78821955657999], 'bpsp': [1.6040769444444445, 1.2749988611111112, 1.0718360277777779, 0.9390145, 0.8420585277777778, 0.7695107777777778, 0.6614950277777778, 0.44234005555555556, 0.2817363333333333, 0.22181044444444445, 0.18575369444444445]},
    },
    {
    'filename':'GF6_WFI_Sample_B.tif',
    'jxl_dlpr_linear':{'psnr': [56.759992282579205, 54.94120112659931, 53.67195472177467, 52.69986276094879, 51.895784847204645, 51.22153928001861, 50.12300793179352, 47.39256867619985, 44.26111880774635, 41.826933405980036, 39.23917842246135], 'bpsp': [1.3692308888888889, 1.0589559722222222, 0.8789730833333333, 0.7668835, 0.6874400833333333, 0.6281710555555555, 0.5427189166666667, 0.369767, 0.24239666666666668, 0.19685802777777778, 0.1690751388888889]},
    'jxl_dlpr_msb':{'psnr': [56.24275228396413, 54.38008006038012, 53.10749661294365, 52.13635487193909, 51.33964065500681, 50.67743766763926, 49.618371283847054, 47.08481130437622, 44.12536917502396, 41.74973933366619, 39.1964955780159], 'bpsp': [1.3192212222222222, 1.01507625, 0.8462108333333334, 0.7402603888888889, 0.6639875833333333, 0.6063401666666667, 0.5227141111111111, 0.35361302777777776, 0.22895969444444444, 0.18358313888888889, 0.15580058333333333]},
    },
    {
    'filename':'GF6_WFI_Sample_C.tif',
    'jxl_dlpr_linear':{'psnr': [55.872689784733616, 53.91129541668998, 52.5403755182327, 51.55799133413089, 50.79418136852918, 50.18118211261339, 49.21315385713526, 46.79145470573242, 43.656809902384104, 41.073477714322166, 38.69985126486154], 'bpsp': [1.6004735277777777, 1.2654616666666667, 1.0441958333333334, 0.8962637222222222, 0.7923844722222222, 0.7178136666666667, 0.6118144444444444, 0.4199684722222222, 0.2778090833333333, 0.2221508611111111, 0.19366758333333334]},
    'jxl_dlpr_msb':{'psnr': [55.472401174184604, 53.41700818527828, 52.066185390491356, 51.12313690205083, 50.39348267747269, 49.807067432571095, 48.883144794322604, 46.5917836360596, 43.564466077131165, 41.02257688000222, 38.67030684396246], 'bpsp': [1.5372231944444446, 1.20498575, 0.9926578055555556, 0.8552774722222222, 0.7596193888888889, 0.6902055833333334, 0.589327, 0.4027230277777778, 0.26191708333333336, 0.2063195277777778, 0.17783636111111112]},
    },
    {
    'filename':'GF6_WFI_Sample_D.tif',
    'jxl_dlpr_linear':{'psnr': [56.579317268718, 54.777232401064, 53.64945336135514, 52.90818112018202, 52.35026372183572, 51.917494535408856, 51.21999229737415, 49.20296698676743, 46.13337515074115, 43.63876819945908, 41.65801097776747], 'bpsp': [1.1909694722222222, 0.8765560277777777, 0.6879843611111112, 0.5763933333333333, 0.5043902222222222, 0.45689725, 0.39335319444444444, 0.28160905555555554, 0.1913391111111111, 0.15751219444444445, 0.14275997222222223]},
    'jxl_dlpr_msb':{'psnr': [56.20382318249079, 54.35869430143356, 53.28487613161691, 52.59841946342199, 52.081250385098514, 51.67611672955428, 51.01529523158324, 49.07587959436091, 46.07168964458448, 43.604029726212715, 41.635936655621535], 'bpsp': [1.1290034722222222, 0.8221214444444445, 0.6478573055555555, 0.5478946388888889, 0.48280297222222224, 0.43901633333333334, 0.37839941666666665, 0.2681719444444444, 0.17810744444444446, 0.14428941666666667, 0.12953708333333333]},
    }, 
    {
    'filename':'GF6_PMS_Sample_A.tif',
    'jxl_dlpr_linear':{'psnr': [54.85892068495828, 52.42403683898114, 50.60387860132694, 49.18069792576741, 48.01940071651263, 47.051093005093634, 45.515232311164084, 42.11097507211906, 39.40837254854976, 37.50576382103117, 35.35684063236652], 'bpsp': [2.374157611111111, 1.874933611111111, 1.5814835555555555, 1.3872426111111111, 1.245350888888889, 1.1382397222222222, 0.9822342222222222, 0.6491578888888889, 0.4175086111111111, 0.34866144444444447, 0.3099642777777778]},
    'jxl_dlpr_msb':{'psnr': [54.60871349586697, 52.081827856170484, 50.22756720145617, 48.79176611012939, 47.6304955146759, 46.66969267087029, 45.16461663646414, 41.938699287464615, 39.374971178001694, 37.496015852404746, 35.351462209660525], 'bpsp': [2.295236111111111, 1.8049187777777778, 1.5206549444444444, 1.334006111111111, 1.1966233333333334, 1.0927362222222223, 0.9411689444444444, 0.618952, 0.4027897777777778, 0.3372796111111111, 0.2986621666666667]},
    },
    {
    'filename':'GF6_PMS_Sample_B.tif',
    'jxl_dlpr_linear':{'psnr': [55.02285341898657, 52.669956288583506, 50.94384373280418, 49.57934889357518, 48.45023794303983, 47.493225964385104, 45.94085799569346, 42.27924665476497, 39.29394550348212, 37.314244503364506, 35.3433453545416], 'bpsp': [2.3175097222222223, 1.8121837777777778, 1.5278150555555556, 1.3428316111111112, 1.2083252222222223, 1.105634888888889, 0.9524248333333334, 0.6316855555555555, 0.42720855555555554, 0.35786372222222224, 0.3215851111111111]},
    'jxl_dlpr_msb':{'psnr': [54.80694536931696, 52.3980495846828, 50.66146924329424, 49.30102700864068, 48.18232347960744, 47.23920292397969, 45.72000928376851, 42.17700730979477, 39.268041092763, 37.30176604624751, 35.3355151551093], 'bpsp': [2.2520873333333333, 1.7573756111111112, 1.482453611111111, 1.3036966666666667, 1.1733416666666667, 1.0733543333333333, 0.9239155, 0.6119125, 0.4150781666666667, 0.3472523888888889, 0.310987]},
    },
    {
    'filename':'GF6_PMS_Sample_C.tif',
    'jxl_dlpr_linear':{'psnr': [54.60995193124772, 52.04103357638501, 50.083529068985165, 48.54649093887656, 47.29576589582089, 46.256112274415585, 44.622379798989975, 41.085677401175964, 38.416168916584326, 36.58990185165434, 34.51011258788559], 'bpsp': [2.767111277777778, 2.2336149444444446, 1.9032908888888889, 1.6761580555555555, 1.5058832777777778, 1.3763060555555555, 1.1864922222222223, 0.7844841666666666, 0.5010317222222223, 0.42116916666666665, 0.379823]},
    'jxl_dlpr_msb':{'psnr': [54.302432975134636, 51.61605727148351, 49.61555650772388, 48.063388937645215, 46.813041128389074, 45.78276646360361, 44.18790314510385, 40.86465326152003, 38.375216794118, 36.58163534095643, 34.5055961566805], 'bpsp': [2.666589888888889, 2.141999111111111, 1.8200449444444444, 1.6005573333333334, 1.4358601111111111, 1.3105309444444444, 1.1264590555555556, 0.7404927222222222, 0.480258, 0.40677677777777776, 0.3655494444444444]},
    },
    {
    'filename':'GF6_PMS_Sample_D.tif',
    'jxl_dlpr_linear':{'psnr': [55.03024135566615, 52.65094300838857, 50.856638813985946, 49.433559744218876, 48.25747813339193, 47.26369259414675, 45.654732756971946, 41.89844926134572, 38.70856579094679, 36.68101311101838, 34.613453285044315], 'bpsp': [2.4876039444444444, 1.9958459444444445, 1.7074033333333334, 1.5117533333333333, 1.365946388888889, 1.2545159444444445, 1.0878789444444446, 0.7347356666666667, 0.4882081111111111, 0.4073892777777778, 0.36292644444444444]},
    'jxl_dlpr_msb':{'psnr': [54.75083277384136, 52.29283420991186, 50.48518672152766, 49.066392002308355, 47.90093182467629, 46.92136385342404, 45.350973764110904, 41.75712720558064, 38.67655151631047, 36.66714450954267, 34.605024905894545], 'bpsp': [2.412043277777778, 1.9299966666666666, 1.6495150555555556, 1.4599679444444444, 1.3190525555555555, 1.2109693333333333, 1.0487072222222222, 0.707019, 0.4731881111111111, 0.39496722222222225, 0.350536]},
    }, 
]


def results2csv():
    file_paths = [
        "TRIPLESAT_2_MS_L1_20191107021947_001FFCVI_002_0120200811001001_001.tif",
        "TRIPLESAT_2_MS_L1_20191107021950_001FFCVI_003_0120200811001001_002.tif",
        "TRIPLESAT_2_MS_L1_20191107021954_001FFCVI_004_0120200811001001_001.tif",
        "TRIPLESAT_2_MS_L1_20200109023258_002115VI_003_0120200811001001_001.tif",
        "TRIPLESAT_2_MS_L1_20200109023301_002115VI_004_0120200811001001_001.tif",
        "GF6_WFI_Sample_A.tif",
        "GF6_WFI_Sample_B.tif",
        "GF6_WFI_Sample_C.tif",
        "GF6_WFI_Sample_D.tif",
        "GF6_PMS_Sample_A.tif",
        "GF6_PMS_Sample_B.tif",
        "GF6_PMS_Sample_C.tif",
        "GF6_PMS_Sample_D.tif",
    ]
    n_subpixels = [
        4 * 7340 * 7815,
        4 * 7340 * 7815,
        4 * 7340 * 7815,
        4 * 7605 * 7815,
        4 * 7605 * 7815,
        8 * 6000 * 6000,
        8 * 6000 * 6000,
        8 * 6000 * 6000,
        8 * 6000 * 6000,
        4 * 6000 * 6000,
        4 * 6000 * 6000,
        4 * 6000 * 6000,
        4 * 6000 * 6000,
    ]

    method = 'jxl_dlpr_linear'
    csv_file = f'SOTA_results/DLPR_nll_11rps.csv'
    with open(csv_file, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)
        metrics = ['MSE', 'PSNR', 'bpsp', 'bits']
        csv_headers = ['K'] + [f"{path}_{metric}" for path in file_paths for metric in metrics]
        writer.writerow(csv_headers)
        # for K in range(1, 7):
        for K in range(1, 12):
            row = [f"K{K}"] + [None] * (len(file_paths) * 4)
            for i, file_path in enumerate(file_paths):
                psnr = experiment_result[i][method]['psnr'][K-1]
                mse = 10000 ** 2 / 10 ** (psnr/10)
                bpsp = experiment_result[i][method]['bpsp'][K-1]
                bits = bpsp * n_subpixels[i]
                int_bits = int(round(bits))
                if abs(int_bits - bits) > 1e-6: print(int_bits - bits)
                row[4*i+1] = mse
                row[4*i+2] = psnr
                row[4*i+3] = bpsp
                row[4*i+4] = int_bits 
            writer.writerow(row)


if __name__ == "__main__":
    results2csv()
